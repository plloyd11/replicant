---
import { Image } from 'astro:assets';

// Import all hero images eagerly so they're available at build time
const heroImages = import.meta.glob<{ default: ImageMetadata }>('../../assets/heros/*.jpg', {
    eager: true,
});
const heroImagesArray = Object.values(heroImages);
---

<section id="intro" class="relative mt-6 bg-replicant-900">
    <div class="lg:relative lg:flex lg:items-center">
        <div class="flex relative flex-col mx-auto max-w-screen-2xl">
            <div
                class="flex order-2 justify-center items-center px-4 mt-4 w-full md:justify-between lg:mt-0 2xl:px-0 lg:order-1"
            >
                <p
                    class="font-semibold text-center uppercase md:text-left text-replicant-300 xl:text-xl"
                >
                    Respect New Jersey or prepare for combat
                </p>
                <p
                    class="hidden text-sm font-semibold uppercase md:block text-replicant-300 xl:text-xl"
                >
                    EST. MMXIV
                </p>
            </div>
            <div class="order-1 lg:order-2">
                <div id="hero-images" class="relative">
                    {
                        heroImagesArray.map((hero, index) => (
                            <Image
                                class="hero-image"
                                data-index={index}
                                src={hero.default}
                                alt="Photo of one of the members in Replicant playing a live show"
                                format="avif"
                                quality={90}
                                style={index === 0 ? '' : 'display: none;'}
                            />
                        ))
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // This runs on every page load in the browser
    function randomizeHeroImage() {
        const heroImages = document.querySelectorAll<HTMLImageElement>('.hero-image');
        if (heroImages.length === 0) return;

        // Hide all images first
        heroImages.forEach((img) => {
            img.style.display = 'none';
        });

        // Randomly select and show one
        const randomIndex = Math.floor(Math.random() * heroImages.length);
        heroImages[randomIndex].style.display = 'block';
    }

    // Run immediately when the page loads
    randomizeHeroImage();
</script>
